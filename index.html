<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Downloader</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        input, select {
            width: 80%;
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        #downloadLink, #videoInfo {
            display: block;
            margin-top: 20px;
            font-size: 18px;
            color: blue;
            text-decoration: underline;
        }
        #videoInfo {
            color: black;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <h1>YouTube Downloader</h1>
    <input type="text" id="videoUrl" placeholder="Paste YouTube URL here">
    <select id="format">
        <option value="mp4">MP4 Video</option>
        <option value="mp3">MP3 Audio</option>
    </select>
    <select id="resolution">
        <option value="best">Best Available</option>
        <option value="2160p">4K (2160p)</option>
        <option value="1440p">2K (1440p)</option>
        <option value="1080p">Full HD (1080p)</option>
        <option value="720p">HD (720p)</option>
        <option value="480p">SD (480p)</option>
        <option value="360p">Low Quality (360p)</option>
    </select>
    <button onclick="downloadVideo()">Download</button>
    <div id="videoInfo"></div>
    <div id="downloadLink"></div>

    <script>
        async function downloadVideo() {
            const url = document.getElementById('videoUrl').value;
            const videoId = url.split('v=')[1] || url.split('/')[url.split('/').length - 1];
            const format = document.getElementById('format').value;
            const resolution = document.getElementById('resolution').value;

            if (!videoId) {
                alert("Invalid YouTube URL");
                return;
            }

            const apiUrl = `https://youtube-dl-api.herokuapp.com/dl?url=https://www.youtube.com/watch?v=${videoId}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'GET',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();

                let downloadUrl = null;
                let title = data.title;
                let artist = data.uploader;

                if (format === 'mp4') {
                    for (let fmt of data.format) {
                        if (fmt.quality === resolution) {
                            downloadUrl = fmt.url;
                            break;
                        }
                    }
                } else if (format === 'mp3') {
                    const audioFormat = data.format.find(f => f.ext === 'm4a');
                    if (audioFormat) {
                        downloadUrl = audioFormat.url;
                    }
                }

                if (downloadUrl) {
                    const link = document.createElement('a');
                    link.href = downloadUrl;
                    link.download = `${title}.${format}`;
                    link.textContent = 'Download Video';
                    document.getElementById('downloadLink').innerHTML = '';
                    document.getElementById('downloadLink').appendChild(link);

                    document.getElementById('videoInfo').innerHTML = `
                        <strong>Title:</strong> ${title}<br>
                        <strong>Artist:</strong> ${artist}<br>
                        <strong>Format:</strong> ${format.toUpperCase()}<br>
                        <strong>Resolution:</strong> ${resolution.toUpperCase()}
                    `;
                } else {
                    alert("Selected format or resolution is not available for this video");
                }
            } catch (error) {
                console.error('Error fetching download link:', error);
                alert("Failed to fetch download link. Please try again later.");
            }
        }
    </script>
</body>
</html>
